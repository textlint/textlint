"use strict";(self.webpackChunktextlint_website=self.webpackChunktextlint_website||[]).push([[8359],{952:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>x,contentTitle:()=>o,default:()=>a,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"rule-fixable","title":"Creating Fixable Rule","description":"textlint has linter and also has fixer.","source":"@site/../docs/rule-fixable.md","sourceDirName":".","slug":"/rule-fixable","permalink":"/textlint/pr-preview/pr-1539/docs/rule-fixable","draft":false,"unlisted":false,"editUrl":"https://github.com/textlint/textlint/edit/master/docs/../docs/rule-fixable.md","tags":[],"version":"current","lastUpdatedBy":"renovate[bot]","lastUpdatedAt":1756519026000,"frontMatter":{"id":"rule-fixable","title":"Creating Fixable Rule"},"sidebar":"docs","previous":{"title":"Creating Filter Rule","permalink":"/textlint/pr-preview/pr-1539/docs/filter-rule"},"next":{"title":"Creating Preset","permalink":"/textlint/pr-preview/pr-1539/docs/rule-preset"}}');var i=t(1273),l=t(6719);const s={id:"rule-fixable",title:"Creating Fixable Rule"},o=void 0,x={},c=[{value:"Publishing",id:"publishing",level:2},{value:"<code>fixable</code> feature is newer",id:"fixable-feature-is-newer",level:3},{value:"Display fixable or not",id:"display-fixable-or-not",level:3},{value:"Terms",id:"terms",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["textlint has ",(0,i.jsx)(n.code,{children:"linter"})," and also has ",(0,i.jsx)(n.code,{children:"fixer"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"export default function reporter(context) {}\n"})}),"\n",(0,i.jsx)(n.p,{children:"is shorthand function syntax of"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"function reporter(context) {}\nexport default {\n    linter: reporter\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u2139\ufe0f You should know ",(0,i.jsx)(n.a,{href:"/textlint/pr-preview/pr-1539/docs/rule",children:"Creating Rules"})," in advance."]}),"\n",(0,i.jsxs)(n.p,{children:["Now, you can implement ",(0,i.jsx)(n.code,{children:"fixer"})," like that:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"function reporter(context) {\n    // report error and fix command\n}\nexport default {\n    linter: reporter,\n    fixer: reporter\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"fixer"})," does lint and found error"]}),"\n",(0,i.jsxs)(n.p,{children:["If you'd like textlint to attempt to fix the problem you're reporting, you can do so by specifying the fix object when using ",(0,i.jsx)(n.code,{children:"context.report()"}),".\nThe fixer object, that you can use to apply a fix. For example:"]}),"\n",(0,i.jsx)(n.p,{children:"The fixer object has the following methods:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'// TODO: more reasonable example\nconst reporter = (context) => {\n    // `context.fixer`\n    const { Syntax, RuleError, fixer, report, getSource } = context;\n    return {\n        [Syntax.Str](node) {\n            const text = getSource(node);\n            // "You fix this"\n            //      ^^^\n            const matchRegexp = /\\bfix\\b/;\n            if (!matchRegexp.test(text)) {\n                return;\n            }\n            // found "fixable" error\n            const index = text.search(matchRegexp);\n            const length = "fix".length;\n            const replace = fixer.replaceTextRange([index, index + length], "fixed");\n            report(\n                node,\n                new RuleError("Replaced", {\n                    // "You fix this"\n                    //      ^ index\n                    index,\n                    // "You fix this"\n                    //      ^^^\n                    //     fixed\n                    fix: replace\n                })\n            );\n        }\n    };\n};\nexport default {\n    linter: reporter,\n    // This rule has fixer.\n    fixer: reporter\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"context.fixer."})," object has the following methods:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.insertTextAfter(node, text)"})," - inserts text after the given node"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.insertTextAfterRange(range, text)"})," - inserts text after the given range"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.insertTextBefore(node, text)"})," - inserts text before the given node"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.insertTextBeforeRange(range, text)"})," - inserts text before the given range"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.remove(node)"})," - removes the given node"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.removeRange(range)"})," - removes text in the given range"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.replaceText(node, text)"})," - replaces the text in the given node"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fixer.replaceTextRange(range, text)"})," - replaces the text in the given range"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Best practices for fixes:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Make fixes that are as small as possible. Anything more than a single character is risky and could prevent other, simpler fixes from being made."}),"\n",(0,i.jsx)(n.li,{children:"Make one fix per message."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"publishing",children:"Publishing"}),"\n",(0,i.jsxs)(n.p,{children:["You can publish fixable rule to npm that is the same way of a ",(0,i.jsx)(n.a,{href:"/textlint/pr-preview/pr-1539/docs/rule",children:"rule"})]}),"\n",(0,i.jsx)(n.p,{children:"Be careful to following points."}),"\n",(0,i.jsxs)(n.h3,{id:"fixable-feature-is-newer",children:[(0,i.jsx)(n.code,{children:"fixable"})," feature is newer"]}),"\n",(0,i.jsxs)(n.p,{children:["Old ",(0,i.jsx)(n.code,{children:"textlint"})," not support fixable feature, so old ",(0,i.jsx)(n.code,{children:"textlint"})," don't understand ",(0,i.jsx)(n.code,{children:"fixable"}),".\nAs a result, old ",(0,i.jsx)(n.code,{children:"textlint"})," throw error."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Error: Definition for rule 'rule-name' was not found."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["We recommended that add ",(0,i.jsx)(n.code,{children:"peerDependencies"})," to ",(0,i.jsx)(n.code,{children:"package.json"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'  "peerDependencies": {\n    "textlint": ">= 5.5.0"\n  }\n'})}),"\n",(0,i.jsx)(n.h3,{id:"display-fixable-or-not",children:"Display fixable or not"}),"\n",(0,i.jsxs)(n.p,{children:["If your textlint's rule is ",(0,i.jsx)(n.em,{children:"fixable"}),', display "this rule is fixable!".']}),"\n",(0,i.jsxs)(n.p,{children:["We have ",(0,i.jsx)(n.em,{children:"fixable"})," rule badge and use it!"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://textlint.org/",children:(0,i.jsx)(n.img,{src:"https://img.shields.io/badge/textlint-fixable-green.svg?style=social",alt:"textlint rule"})})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-markdown",children:"[![textlint rule](https://img.shields.io/badge/textlint-fixable-green.svg?style=social)](https://textlint.org/) \n"})}),"\n",(0,i.jsx)(n.h2,{id:"terms",children:"Terms"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["fixble rule: A rule report error that could be fixed\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"fixable"})," is ",(0,i.jsx)(n.strong,{children:"fix"}),"-able."]}),"\n"]}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},6719:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var r=t(3917);const i={},l=r.createContext(i);function s(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);